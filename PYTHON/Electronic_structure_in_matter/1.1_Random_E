import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

# Parameters
L = 1.0  # Length of the box
N = 1000  # Number of grid points
dx = L / N  # Grid spacing
x = np.linspace(0, L, N)

# Potential energy (inside the box, V = 0)
V = np.zeros(N)

def schrodinger_psi(y, x, E):
    psi, phi = y
    dpsi_dx = phi
    dphi_dx = -2 * (E - V[int(x)]) * psi
    return [dpsi_dx, dphi_dx]

# Energy search range
E_min = 0.1
E_max = 20.0
num_energies = 10

energies = np.linspace(E_min, E_max, num_energies)

# Find eigenvalues and eigenfunctions using shooting method
eigenvalues = []
eigenfunctions = []

for E in energies:
    psi_initial = [0.0, 1.0]  # Initial conditions: psi(0) = 0, psi'(0) = 1
    psi_solution = odeint(schrodinger_psi, psi_initial, x, args=(E,))
    eigenvalues.append(E)
    eigenfunctions.append(psi_solution[:, 0])

# Plot the eigenfunctions
plt.figure(figsize=(10, 6))
for i in range(num_energies):
    plt.plot(x, eigenfunctions[i], label=f'E = {eigenvalues[i]:.2f}')
plt.xlabel('Position')
plt.ylabel('Wavefunction')
plt.title('Wavefunctions for Particle in a 1D Box')
plt.legend()
plt.show()
